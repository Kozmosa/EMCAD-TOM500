Model pvt_v2_b2 backbone:  created, param count: 24849856
Model EMCAD decoder:  created, param count: 1913515
Model successfully created.
Namespace(activation_mscb='relu6', base_lr=0.0008, batch_size=64, concatenation=False, dataset='tom500', deterministic=1, encoder='pvt_v2_b2', exp='pvt_v2_b2_EMCAD_kernel_sizes_[1, 3, 5]_dw_parallel_add_lgag_ks_3_ef2_act_mscb_relu6_loss_mutation_output_final_layer_Run1_tom500224', expansion_factor=2, img_size=224, kernel_sizes=[1, 3, 5], lgag_ks=3, list_dir='./lists/lists_Synapse', max_epochs=300, max_iterations=50000, n_gpu=1, no_dw_parallel=False, no_pretrain=False, num_classes=9, pretrained_dir='./pretrained_pth/pvt/', root_path='/home/xuyang/code/EMCAD-TOM500/datasets/TOM500_tun/train_npz', seed=2222, supervision='mutation', volume_path='/home/xuyang/code/EMCAD-TOM500/datasets/TOM500_tun/test_vol_h5', z_spacing=1)
The length of train set is: 8000
125 iterations per epoch. 37500 max iterations 
[[0, 1, 2, 3], [1, 2, 3], [0, 2, 3], [2, 3], [0, 1, 3], [1, 3], [0, 3], [3], [0, 1, 2], [1, 2], [0, 2], [2], [0, 1], [1], [0], []]
iteration 50, epoch 0 : loss : 5.677261, lr: 0.000800
iteration 100, epoch 0 : loss : 3.970649, lr: 0.000800
iteration 125, epoch 0 : loss : 3.547315, lr: 0.000800
100 test iterations per epoch
Testing performance in val model: mean_dice : 0.011210, best_dice : 0.000000
save model to model_pth/pvt_v2_b2_EMCAD_kernel_sizes_1_3_5_dw_parallel_add_lgag_ks_3_ef2_act_mscb_relu6_loss_mutation_output_final_layer_Run1_tom500224/pvt_v2_b2_EMCAD_kernel_sizes_1_3_5_dw_parallel_add_lgag_ks_3_ef2_act_mscb_relu6_loss_mutation_output_final_layer_Run1_pretrain_bs64_lr0.0008_224_s2222/best.pth
iteration 150, epoch 1 : loss : 10.121828, lr: 0.000800
iteration 200, epoch 1 : loss : 8.629639, lr: 0.000800
iteration 250, epoch 1 : loss : 7.892800, lr: 0.000800
iteration 250, epoch 1 : loss : 7.892800, lr: 0.000800
100 test iterations per epoch
Testing performance in val model: mean_dice : 0.026383, best_dice : 0.011210
save model to model_pth/pvt_v2_b2_EMCAD_kernel_sizes_1_3_5_dw_parallel_add_lgag_ks_3_ef2_act_mscb_relu6_loss_mutation_output_final_layer_Run1_tom500224/pvt_v2_b2_EMCAD_kernel_sizes_1_3_5_dw_parallel_add_lgag_ks_3_ef2_act_mscb_relu6_loss_mutation_output_final_layer_Run1_pretrain_bs64_lr0.0008_224_s2222/best.pth
iteration 300, epoch 2 : loss : 6.765337, lr: 0.000800
iteration 350, epoch 2 : loss : 6.411152, lr: 0.000800
iteration 375, epoch 2 : loss : 5.251063, lr: 0.000800
100 test iterations per epoch
Testing performance in val model: mean_dice : 0.039942, best_dice : 0.026383
save model to model_pth/pvt_v2_b2_EMCAD_kernel_sizes_1_3_5_dw_parallel_add_lgag_ks_3_ef2_act_mscb_relu6_loss_mutation_output_final_layer_Run1_tom500224/pvt_v2_b2_EMCAD_kernel_sizes_1_3_5_dw_parallel_add_lgag_ks_3_ef2_act_mscb_relu6_loss_mutation_output_final_layer_Run1_pretrain_bs64_lr0.0008_224_s2222/best.pth
iteration 400, epoch 3 : loss : 5.277265, lr: 0.000800
iteration 450, epoch 3 : loss : 4.875748, lr: 0.000800
iteration 500, epoch 3 : loss : 5.319884, lr: 0.000800
iteration 500, epoch 3 : loss : 5.319884, lr: 0.000800
100 test iterations per epoch
Testing performance in val model: mean_dice : 0.043698, best_dice : 0.039942
save model to model_pth/pvt_v2_b2_EMCAD_kernel_sizes_1_3_5_dw_parallel_add_lgag_ks_3_ef2_act_mscb_relu6_loss_mutation_output_final_layer_Run1_tom500224/pvt_v2_b2_EMCAD_kernel_sizes_1_3_5_dw_parallel_add_lgag_ks_3_ef2_act_mscb_relu6_loss_mutation_output_final_layer_Run1_pretrain_bs64_lr0.0008_224_s2222/best.pth
iteration 550, epoch 4 : loss : 4.918021, lr: 0.000800
iteration 600, epoch 4 : loss : 4.053910, lr: 0.000800
iteration 625, epoch 4 : loss : 4.754893, lr: 0.000800
100 test iterations per epoch
Testing performance in val model: mean_dice : 0.038116, best_dice : 0.043698
iteration 650, epoch 5 : loss : 4.439873, lr: 0.000800
iteration 700, epoch 5 : loss : 3.254883, lr: 0.000800
iteration 750, epoch 5 : loss : 3.131144, lr: 0.000800
iteration 750, epoch 5 : loss : 3.131144, lr: 0.000800
100 test iterations per epoch
